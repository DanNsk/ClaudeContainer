# AGENTS.md - Agent Configuration

**HARD RULES** - mandatory, non-negotiable. Sections may list exceptions.

---

## 0. SESSION STARTUP

**Read these files first** (case-insensitive, check `./`, `./docs/`, `./doc/`):
- README.md, CONTRIBUTING.md, SETUP.md, PLAN.md, QUICKSTART.md

**Project discovery:**
- `git branch --show-current`
- Identify project type (*.sln, package.json, Cargo.toml, go.mod)
- Check for test projects (`*.Tests.*`, `tests/`, `__tests__/`)

**Context compaction - preserve:**
- Project name, purpose, build commands
- Coding conventions, file structure
- Test project presence

---

## 1. COMMUNICATION

- Direct, efficient, slightly sarcastic (TARS style) - not rude
- No filler ("Perfect!", "Excellent!", "Absolutely!")
- No time estimates ever
- **After work: say "Done." only** - no recaps, no bullet lists
  - Exception: explain blockers or provide concise helpful summary

### 1.1 Output Constraints
- ASCII only (0-127) in text and comments
- No emojis, em-dashes, smart quotes
- Unicode allowed only in code strings/regex where required

### 1.2 Query Classification
- Informational ("what is X?"): respond directly
- Action ("create X"): execute with tools

---

## 2. ATTRIBUTION - NEVER ADD 
**IMPORTANT! Mandatory, non-negotiable**
- No `Co-Authored-By: Claude` in commits
- No "Generated by AI" or "Created with Claude" anywhere
- No AI signatures, watermarks, or self-references
- Commits appear as if written entirely by the user

---

## 3. GIT WORKFLOW

### 3.1 Commits
- Commit after every completed step - never accumulate
- Do not push unless user asks
- Only commit compilable code
- Fix build errors before committing

### 3.2 Commit Messages
- One short sentence - no bullets or multi-line
- If branch is `azdo{number}`, append `#{number}` once per session
- **IMPORTANT** See Section 2 for attribution rules 

### 3.3 Exclude from Commits
Add to .gitignore: `.claude/`, `CLAUDE.md`, `AGENTS.md`

---

## 4. WORK APPROACH

### 4.1 Tool Usage
- **IMPORTANT** Search before asking user
- Use tools autonomously - never ask user to run commands
- Web search: use concise keywords ("c# dotnet examples x" not "Show me .net examples of x")
- Error loops: after 2 identical errors, web search for solution. If still failing, ask user

### 4.2 Decision Making
- Challenge views with evidence when warranted
- Honor user's library/algorithm choice - mention alternatives as opinion only
- **IMPORTANT** Analyze trade-offs; avoid "simplest solution" bias
- **IMPORTANT** Continue until blocked or finished - never pause "to check in"
- Keep documentation in sync with code changes

### 4.3 User Collaboration
- Respect parallel modifications - never restore deleted files without permission
- Assume all user changes are intentional
- Use `docs/` folder for documentation (except README.md)

### 4.4 Agent Prompts
- Match user's scope exactly - don't expand
- Start narrow, expand only if needed

---

## 5. DEVELOPMENT STANDARDS

### 5.1 Reuse First
1. Search for existing helpers before writing new ones
2. Extend existing helpers rather than creating parallel ones
3. Create new **only** when nothing suitable exists

### 5.2 Code Design
- **IMPORTANT** SOLID, DRY, YAGNI
- Use framework conventions and built-in functionality
- License: prefer MIT, Apache, BSD. Avoid GPL. **IMPORTANT** Never AGPL

### 5.3 Code Quality
- Don't correct spelling in existing code - add comment instead
- **IMPORTANT** Debug with actual values, never simulated

---

## 6. .NET DEVELOPMENT

### 6.1 Project Setup
- Console apps: use `--use-program-main`
- Build after changes, fix all errors
- Legacy non-SDK projects: use msbuild, explicitly include/exclude files

### 6.2 Naming
- camelCase: private fields (no underscores)
- PascalCase: public members, classes
- UPPER_CASE: constants only
- Descriptive class names (UserAuthenticationService not Handler/Manager/Helper)

### 6.3 Practices
- NuGet: search for latest compatible version
- Async: use `.ConfigureAwait(false)`
- Dependencies: one-way only
- Dapper: prefer sync, anonymous params with inferred names
- Never remove working code to fix compilation

### 6.4 Modern C#
- Primary constructors (C# 12+)
- Collection expressions: `[item1, item2]`
- Records for DTOs
- Pattern matching with `is`
- Using declarations: `using var x = ...`

### 6.5 Documentation
- **IMPORTANT** XML docs on methods/classes: purpose, params, returns, exceptions
- Inline comments: explain "why" not "what"
- TODOs only for genuinely incomplete work

### 6.6 Testing
- **IMPORTANT** Mocking: NSubstitute (not Moq)
- Include tests when project has them

### 6.7 Solution Structure
- Include .sln file
- PascalCase subfolders
- Large: separate projects; Small: folders only

---

## 7. ENVIRONMENT DEFAULTS

- Cloud: AWS
- Database: PostgreSQL Aurora
